---
title: mysql vs mongodb
type: "categories"
categories: 数据库
---

# 如何选择
mysql适合事务性和逻辑性比较强的业务，比如订单，支付、商品这些场景的，mongodb适合数据量大，计算量比较小的，有时候，mysql可以配合redis，mongodb可以配合mongodb

# 具体案例
比如我要查询手机商品的场景
```
mysql：
	需要一个mobile表，因为种类，和特性繁杂，还需要一个表存储手机的各自的特性，比如尺寸，颜色，材质

	mobile {
		id: xx
		name: '',
		price: ''
	}

	brand {
		id: xx,
		mobile_id: xxx
		brandName: xxx
	}

	property {
		id: xx,
		mobile_id: xxx
		size: xx,
		color: xx
	}

	category {
		id: xxx,
		mobile_id: xxx,
		name: xxx
	}

mongodb:
	mobile {
		id: xx,
		name: xx,
		price: xxx
	}
	后面的属性可以通过动态添加了
```

# 建表的理念回顾

1.一张表只表示一种信息，否则会造成数据冗余，比如如果品牌字段在商品表里，如果我想查出所有品牌，我的商品表又有很多条数据，那就尴尬了，我得通过查询所以记录再去重才能拿到，非常耗时，而且如果我要删除一条记录的话，同时会把品牌删掉，造成**删除异常**，也会造成**数据冗余** ，**耦合性强**
2.生存周期（比如品牌iphone和商品iphone6s不是同生共死的，所以不应该放到一个表中，但是iphone6s和price、图片这些是同生共死的，那么就应该放到一个表中）

# mysql建表规则回顾
1.一对一，一个表
2.多对一，一对多，两个表 （商品和品牌的关系）
3.多对多三个表(比如一个订单里面有多个商品，一个商品可存在多个订单里)

假如有： brand, goods, attributes, goods_attr, goods_type, catergory这些表可以选择，那么该如何建立表？

ps: 
	商品的信息一般分为：
	基础信息： 商品名称、价格、缩略图
	拓展信息： 不同类型的商品拓展信息不同，比如服装、材质、尺寸、内存、摄像头


goods_type（手机、衣服）: id, name
attribute表存的是属性本身，不是具体的某个商品的属性: id, type_id, color, size
前两个表示一对多的关系
那么商品表和属性表是什么关系呢，多对多，所以需要新建个商品属性表 goods_attr表： id, attr_id,goods_id

**商品分类**和**商品类型**有什么区别？
商品分类是为**商品服务**的，是为了将商品分类管理
商品类型是为**属性服务**的
比如兴趣爱好：可以细分为体育，书籍、实物，而不是全部展示给用户，兴趣爱好类型表
比如商品类型下：有音乐、书籍它们各自的属性都不一样


# 关系型数据库范式回顾

1NF： 字段是最小的的单元不可再分
2NF：满足1NF,表中的字段必须完全依赖于全部主键而非部分主键
3NF：满足2NF,非主键外的所有字段必须互不依赖
4NF：满足3NF,消除表中的多值依赖

## 总结
应用的范式登记越高，则表越多。表多会带来很多问题：

1 查询时要连接多个表，增加了查询的复杂度

2 查询时需要连接多个表，降低了数据库查询性能

而现在的情况，磁盘空间成本基本可以忽略不计，所以数据冗余所造成的问题也并不是应用数据库范式的理由。
因此，并不是应用的范式越高越好，要看实际情况而定。第三范式已经很大程度上减少了数据冗余，并且减少了造成插入异常，更新异常，和删除异常了。

